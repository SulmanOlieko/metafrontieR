% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sfametafrontier.R
\name{sfametafrontier}
\alias{sfametafrontier}
\alias{print.sfametafrontier}
\title{Stochastic metafrontier estimation}
\usage{
sfametafrontier(
  formula,
  muhet,
  uhet,
  vhet,
  thet,
  logDepVar = TRUE,
  data,
  subset,
  group = NULL,
  S = 1L,
  udist = "hnormal",
  scaling = FALSE,
  groupType = "sfacross",
  metaMethod = "lp",
  sfaApproach = "ordonnell",
  selectionF = NULL,
  lcmClasses = 2L,
  whichStart = 2L,
  initAlg = "nm",
  initIter = 100L,
  lType = "ghermite",
  Nsub = 100L,
  uBound = Inf,
  intol = 1e-06,
  method = "bfgs",
  hessianType = 1L,
  simType = "halton",
  Nsim = 100L,
  prime = 2L,
  burn = 10L,
  antithetics = FALSE,
  seed = 12345L,
  itermax = 2000L,
  printInfo = FALSE,
  tol = 1e-12,
  gradtol = 1e-06,
  stepmax = 0.1,
  qac = "marquardt",
  ...
)

\method{print}{sfametafrontier}(x, ...)
}
\arguments{
\item{formula}{A symbolic description of the frontier model.}

\item{muhet}{A one-part formula for heterogeneity in the mean of the
pre-truncated distribution (only for \code{groupType = "sfacross"}).}

\item{uhet}{A one-part formula for heteroscedasticity in the one-sided error.}

\item{vhet}{A one-part formula for heteroscedasticity in the two-sided error.}

\item{thet}{A one-part formula for technological heterogeneity in LCM class
construction (only for \code{groupType = "sfalcmcross"}).}

\item{logDepVar}{Logical. Whether the dependent variable is logged. Default
\code{TRUE}.}

\item{data}{The data frame.}

\item{subset}{An optional subset vector.}

\item{group}{Character string. Name of the column in \code{data} that
identifies the technology groups. Must have at least 2 unique values.}

\item{S}{\code{1} (default) for production/profit frontier; \code{-1} for
cost frontier.}

\item{udist}{Character string. Distribution for the one-sided error term.
For \code{groupType = "sfacross"}: all 10 distributions supported (see
\code{\link[sfaR]{sfacross}}). For \code{groupType = "sfaselectioncross"} or
\code{"sfalcmcross"}: only \code{'hnormal'}.}

\item{scaling}{Logical. Scaling property model for \code{groupType =
"sfacross"} when \code{udist = 'tnormal'}. Default \code{FALSE}.}

\item{groupType}{Character string. Type of model used for each group's
frontier. \code{"sfacross"} (default), \code{"sfaselectioncross"},
or \code{"sfalcmcross"}.}

\item{metaMethod}{Character string. Method for estimating the metafrontier.
\itemize{
\item \code{"lp"} (default): Deterministic envelope (column-wise maximum
of group frontier values evaluated at all observations).
\item \code{"qp"}: Constrained OLS of the envelope on \eqn{X}.
\item \code{"sfa"}: Second-stage pooled SFA. The approach depends on
\code{sfaApproach}.
}}

\item{sfaApproach}{Character string. Only relevant when \code{metaMethod =
  "sfa"}. \code{"ordonnell"} (default): uses the envelope of group betas
evaluated at all observations (O'Donnell et al., 2008). \code{"huang"}:
uses each observation's own group fitted value as the meta-stage dependent
variable (Huang et al., 2014).}

\item{selectionF}{A one-sided formula (e.g. \code{~ z1 + z2}) or a named
list of formulas (one per group) specifying the selection equation. Only
used when \code{groupType = "sfaselectioncross"}.}

\item{lcmClasses}{Integer (2--5). Number of latent classes for
\code{groupType = "sfalcmcross"}. Default \code{2}.}

\item{whichStart}{Integer. Starting value strategy for LCM (1 or 2, see
\code{\link[sfaR]{sfalcmcross}}). Default \code{2}.}

\item{initAlg}{Character. Initialization algorithm for LCM. Default
\code{"nm"}.}

\item{initIter}{Integer. Initialization iterations for LCM. Default
\code{100}.}

\item{lType}{Character. Likelihood type for selection model. Default
\code{"ghermite"}.}

\item{Nsub}{Integer. Quadrature nodes/subdivisions for selection model.
Default \code{100}.}

\item{uBound}{Numeric. Upper bound for integration in selection model.
Default \code{Inf}.}

\item{intol}{Numeric. Integration tolerance for selection model. Default
\code{1e-6}.}

\item{method}{Optimization algorithm for group models. Default \code{'bfgs'}.}

\item{hessianType}{Integer (\code{1} or \code{2}). Default \code{1}.}

\item{simType}{Simulation type for MSL. Default \code{'halton'}.}

\item{Nsim}{Number of MSL draws. Default \code{100}.}

\item{prime}{Prime number for Halton draws. Default \code{2}.}

\item{burn}{Initial Halton draws discarded. Default \code{10}.}

\item{antithetics}{Logical. Default \code{FALSE}.}

\item{seed}{Numeric seed. Default \code{12345}.}

\item{itermax}{Maximum iterations. Default \code{2000}.}

\item{printInfo}{Logical. Default \code{FALSE}.}

\item{tol}{Convergence tolerance. Default \code{1e-12}.}

\item{gradtol}{Gradient tolerance. Default \code{1e-06}.}

\item{stepmax}{Step max for \code{ucminf}. Default \code{0.1}.}

\item{qac}{QAC for \code{'bhhh'}/\code{'nr'}. Default \code{'marquardt'}.}

\item{...}{Additional arguments passed to the second-stage SFA call when
\code{metaMethod = "sfa"}.}

\item{x}{An object of class \code{'sfametafrontier'} (for printing).}
}
\value{
A list of class \code{'sfametafrontier'} with the standard components
(see the base \code{sfametafrontier} documentation) plus:
\item{groupType}{The group model type used.}
\item{sfaApproach}{The SFA approach used (when \code{metaMethod = "sfa"}).}
}
\description{
\code{\link{sfametafrontier}} estimates a stochastic metafrontier model
following Battese, Rao and O'Donnell (2004) and O'Donnell, Rao and
Battese (2008). It can also use the two-stage approach of Huang, Huang and
Liu (2014). Three types of group-level frontier models are supported:
standard SFA (\code{\link[sfaR]{sfacross}}), sample selection SFA
(\code{\link[sfaR]{sfaselectioncross}}), and latent class SFA
(\code{\link[sfaR]{sfalcmcross}}).
}
\details{
The workflow:
\enumerate{
\item Estimate group-specific frontiers using the estimator specified by
\code{groupType}.
\item Estimate a common metafrontier using \code{metaMethod}.
\item Compute the metatechnology ratio (MTR) = TE_meta / TE_group for
each observation.
}

When \code{groupType = "sfaselectioncross"}, only the selected observations
(\code{selectDum == 1}) participate in the metafrontier; the MTR is
\code{NA} for non-selected observations.

When \code{groupType = "sfalcmcross"}, the best-posterior-class fitted value
is used as each observation's group frontier value.
}
\examples{
\dontrun{
## Standard SFA metafrontier (LP) with ricephil data
data("ricephil")
ricephil$group <- cut(ricephil$AREA,
  breaks = c(0, 1, 2, Inf),
  labels = c("small", "medium", "large")
)

meta_lp <- sfametafrontier(
  formula = log(PROD) ~ log(AREA) + log(LABOR) + log(NPK) + log(OTHER),
  data = ricephil, group = "group", S = 1, udist = "hnormal",
  metaMethod = "lp"
)
summary(meta_lp)

## Huang (2014) two-stage SFA metafrontier
meta_huang <- sfametafrontier(
  formula = log(PROD) ~ log(AREA) + log(LABOR) + log(NPK) + log(OTHER),
  data = ricephil, group = "group", S = 1, udist = "hnormal",
  metaMethod = "sfa", sfaApproach = "huang"
)
summary(meta_huang)

## Latent class group models
meta_lcm <- sfametafrontier(
  formula = log(PROD) ~ log(AREA) + log(LABOR) + log(NPK) + log(OTHER),
  data = ricephil, group = "group", S = 1,
  groupType = "sfalcmcross", lcmClasses = 2, metaMethod = "lp"
)
}

}
\references{
Battese, G. E., Rao, D. S. P., and O'Donnell, C. J. 2004. A metafrontier
production function for estimation of technical efficiencies and technology
gaps for firms operating under different technologies.
\emph{Journal of Productivity Analysis}, \bold{21}(1), 91--103.

Huang, C. J., Huang, T.-H., and Liu, N.-H. 2014. A new approach to
estimating the metafrontier production function based on a stochastic
frontier framework. \emph{Journal of Productivity Analysis},
\bold{42}(3), 241--254.

O'Donnell, C. J., Rao, D. S. P., and Battese, G. E. 2008. Metafrontier
frameworks for the study of firm-level efficiencies and technology ratios.
\emph{Empirical Economics}, \bold{34}(2), 231--255.
}
\seealso{
\code{\link[sfaR]{sfacross}}, \code{\link[sfaR]{sfaselectioncross}},
\code{\link[sfaR]{sfalcmcross}}
}
\keyword{metafrontier}
\keyword{models}
\keyword{optimize}
